---
emoji: ğŸ”
title: discord.js ã‚’ä½¿ã£ã¦ Discord ä¸Šã§ Google æ¤œç´¢ãŒã§ãã‚‹ Bot ã‚’ä½œã‚‹æ–¹æ³•
summary: discord.js ã‚’ä½¿ã£ã¦ Discord ä¸Šã§ Google æ¤œç´¢ãŒã§ãã‚‹ Bot ã‚’ä½œã‚‹æ–¹æ³•
tags: ['Discord']
date: '2021-03-23'
draft: false
---

â€»ã“ã®è¨˜äº‹ã®æ–¹æ³•ã¯ç¾åœ¨ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚Google ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ãªã©ã§ä»£ç”¨ã—ã¦ãã ã•ã„ã€‚

ã“ã‚“ã«ã¡ã¯ã€Khsmty ã§ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€discord.js ã§ Google æ¤œç´¢æ©Ÿèƒ½ã‚’ä½œã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

## å‰ææ¡ä»¶

- Node.js ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹
- discord.js ã‚’ä½¿ã£ã¦ bot ãŒèµ·å‹•ã§ãã¦ã„ã‚‹

## Step1 å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
$ npm install serp request
```

â†‘ã‚’å®Ÿè¡Œã—ã¦serpã¨requestã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

ä½¿ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã“ã‚Œã ã‘ã§ã™ã€‚ç°¡å˜ã§ã™ã­ã€‚

## Step2 ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ã

### Step2.1 ã‚³ãƒãƒ³ãƒ‰ã‚’æ±ºã‚ã‚‹

å˜ç´”ãªã®ãŒã„ã„ã¨æ€ã„ã¾ã™ã€‚ã“ã“ã§ã¯ `!search` ã«ã—ã¦ãŠãã¾ã™ã€‚

```
if (message.content.startsWith("!search")) {

}
```

### Step2.2 æ¤œç´¢èªå¥ã ã‘åˆ‡ã‚Šå–ã‚‹

`message.content` (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãã®ã¾ã¾) ã‚’ãã®ã¾ã¾æ¤œç´¢ã«ã‹ã‘ã‚‹ã¨ã€ä¸è¦ãªã‚³ãƒãƒ³ãƒ‰éƒ¨åˆ†ã¾ã§æ¤œç´¢ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã®ã§ã€æ¤œç´¢èªå¥ã ã‘åˆ‡ã‚Šå–ã£ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

`.replace(searchCmd, "")` éƒ¨åˆ†ã§ã‚³ãƒãƒ³ãƒ‰æ–‡ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚

```
const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");
}
```

### Step2.3 serpã®è¨­å®š

https://www.npmjs.com/package/serp

serpã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«ã—ã¦æ›¸ã„ã¦ã„ãã¾ã™ã€‚

```
const serp = require("serp");

const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");

  const options = {
    host : "google.co.jp",
    qs : {
      q : searchword,
      filter : 0,
      pws : 0
    },
    num : 3
  };
  const links = await serp.search(options);
}
```

### Step2.4 çµæœã‚’ Discord ã«é€ä¿¡ã™ã‚‹

`<Channel>.send()` ã§çµæœã‚’ãƒãƒ£ãƒ³ãƒãƒ«ã«é€ä¿¡ã—ã¾ã™ã€‚

```
const serp = require("serp");

const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");

  const options = {
    host : "google.co.jp",
    qs : {
      q : searchword,
      filter : 0,
      pws : 0
    },
    num : 3
  };
  const links = await serp.search(options);

  message.channel.send({
    embed: {
      title: "æ¤œç´¢çµæœ",
      description:
        `[${links[0].title}](https://www.google.co.jp${links[0].url})\n\n` +
        `[${links[1].title}](https://www.google.co.jp${links[1].url})\n\n` +
        `[${links[2].title}](https://www.google.co.jp${links[2].url})`,
      color: "#4285F4"
    }
  });
}
```

### Step2.5 æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆ

ä¸Šã¾ã§ã®ã‚³ãƒ¼ãƒ‰ã§ã‚‚æ¤œç´¢ã¯ã§ãã‚‹ã®ã§ã™ãŒã€ã‚‚ã—æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚‰ã€bot ãŒã‚¨ãƒ©ãƒ¼ã‚’åãã ã‘ã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã•ã‚Œãªã„ã¾ã¾è½ã¡ã¦ã—ã¾ã„ã¾ã™ã€‚

ãªã®ã§ã€è¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸæ™‚ç”¨ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚

```
const serp = require("serp");

const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");

  try {
    const options = {
      host : "google.co.jp",
      qs : {
        q : searchword,
        filter : 0,
        pws : 0
      },
      num : 3
    };
    const links = await serp.search(options);

    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description:
          `[${links[0].title}](https://www.google.co.jp${links[0].url})\n\n` +
          `[${links[1].title}](https://www.google.co.jp${links[1].url})\n\n` +
          `[${links[2].title}](https://www.google.co.jp${links[2].url})`,
        color: "#4285F4"
      }
    });
  } catch (e) {
    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description: `æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚ˆã†ã§ã™â€¦\næ¤œç´¢èªå¥ã‚’å¤‰ãˆã¦ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚`,
        color: "#4285F4"
      }
    });
  }
}
```

## ã‚³ãƒ¼ãƒ‰å…¨æ–‡

ã“ã®è¨˜äº‹ã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã®å…¨æ–‡ã§ã™ã€‚

```
const serp = require("serp");

const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");

  try {
    const options = {
      host : "google.co.jp",
      qs : {
        q : searchword,
        filter : 0,
        pws : 0
      },
      num : 3
    };
    const links = await serp.search(options);

    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description:
          `[${links[0].title}](https://www.google.co.jp${links[0].url})\n\n` +
          `[${links[1].title}](https://www.google.co.jp${links[1].url})\n\n` +
          `[${links[2].title}](https://www.google.co.jp${links[2].url})`,
        color: "#4285F4"
      }
    });
  } catch (e) {
    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description: `æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚ˆã†ã§ã™â€¦\næ¤œç´¢èªå¥ã‚’å¤‰ãˆã¦ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚`,
        color: "#4285F4"
      }
    });
  }
}
```

## ãŠã¾ã‘ ç‰¹å®šã®ã‚µã‚¤ãƒˆå†…ã‚’æ¤œç´¢ã™ã‚‹

http://example.comã¯æ¤œç´¢ã—ãŸã„ã‚µã‚¤ãƒˆã® URL ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

```
const serp = require("serp");

const searchCmd = "!search";

if (message.content.startsWith(searchCmd)) {
  const searchWord = message.content.replace(searchCmd, "");

  try {
    const options = {
      host : "google.co.jp",
      qs : {
        q : searchword + " site:http://example.com",
        filter : 0,
        pws : 0
      },
      num : 3
    };
    const links = await serp.search(options);

    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description:
          `[${links[0].title}](https://www.google.co.jp${links[0].url})\n\n` +
          `[${links[1].title}](https://www.google.co.jp${links[1].url})\n\n` +
          `[${links[2].title}](https://www.google.co.jp${links[2].url})`,
        color: "#4285F4"
      }
    });
  } catch (e) {
    message.channel.send({
      embed: {
        title: "æ¤œç´¢çµæœ",
        description: `æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸã‚ˆã†ã§ã™â€¦\næ¤œç´¢èªå¥ã‚’å¤‰ãˆã¦ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚`,
        color: "#4285F4"
      }
    });
  }
}
```

## ãŠã‚ã‚Š

æ‹™ã„æ–‡ã§ã—ãŸãŒã“ã“ã¾ã§ãŠèª­ã¿ãã ã•ã‚Šã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸâ€¦ï¼

å‹•ã‹ãªã„ã˜ã‚ƒã‚“ï¼ã¨ã‹ã€ã“ã“èª­ã¿ã«ãã„ï¼æ›¸ãç›´ã›ï¼ã¨ã‹ãŒã‚ã‚Œã°ã€ã©ã†ãä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚